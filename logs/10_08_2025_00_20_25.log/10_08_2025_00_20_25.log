[ 2025-10-08 00:20:28,560 ] 22 root - INFO - Initiate the data ingestion
[ 2025-10-08 00:20:39,847 ] 132 root - INFO - Used time-based split for train/test.
[ 2025-10-08 00:20:39,849 ] 133 root - INFO - Performed train test split on the dataframe
[ 2025-10-08 00:20:39,849 ] 134 root - INFO - Exited split_data_as_train_test method of Data_Ingestion class
[ 2025-10-08 00:20:39,849 ] 137 root - INFO - Exporting train and test file path.
[ 2025-10-08 00:20:40,012 ] 144 root - INFO - Exported train and test file path.
[ 2025-10-08 00:20:40,021 ] 24 root - INFO - Data Initiation Completed
[ 2025-10-08 00:20:40,021 ] 28 root - INFO - Initiate the data Validation
[ 2025-10-08 00:20:40,021 ] 110 root - INFO - --- Starting Data Validation ---
[ 2025-10-08 00:20:40,100 ] 118 root - INFO - Validating number of columns...
[ 2025-10-08 00:20:40,100 ] 51 root - INFO - Schema requires 17 columns.
[ 2025-10-08 00:20:40,100 ] 52 root - INFO - DataFrame has 17 columns.
[ 2025-10-08 00:20:40,100 ] 51 root - INFO - Schema requires 17 columns.
[ 2025-10-08 00:20:40,100 ] 52 root - INFO - DataFrame has 17 columns.
[ 2025-10-08 00:20:40,100 ] 64 root - INFO - Starting dataset drift detection...
[ 2025-10-08 00:20:40,141 ] 101 root - INFO - Drift detection complete. Report saved to: Artifacts\10_08_2025_00_20_25\data_validation\drift_report\report.yaml
[ 2025-10-08 00:20:40,142 ] 130 root - WARNING - Data drift detected! Check the drift report for details.
[ 2025-10-08 00:20:40,318 ] 146 root - INFO - Data validation artifact: DataValidationArtifact(validation_status=False, valid_train_file_path='Artifacts\\10_08_2025_00_20_25\\data_validation\\validated\\train.csv', valid_test_file_path='Artifacts\\10_08_2025_00_20_25\\data_validation\\validated\\test.csv', invalid_train_file_path=None, invalid_test_file_path=None, drift_report_file_path='Artifacts\\10_08_2025_00_20_25\\data_validation\\drift_report\\report.yaml')
[ 2025-10-08 00:20:40,318 ] 147 root - INFO - --- Data Validation Completed ---
[ 2025-10-08 00:20:40,318 ] 30 root - INFO - data Validation Completed
[ 2025-10-08 00:20:40,318 ] 33 root - INFO - data Transformation started
[ 2025-10-08 00:20:40,318 ] 196 root - INFO - Entered initiate_data_transformation method of DataTransformation class
[ 2025-10-08 00:20:40,572 ] 45 root - INFO - Applying noise filters to sensor data...
[ 2025-10-08 00:20:40,583 ] 45 root - INFO - Applying noise filters to sensor data...
[ 2025-10-08 00:20:40,587 ] 135 root - INFO - Entered get_data_transformer_object method of DataTransformation class
[ 2025-10-08 00:20:40,587 ] 182 root - INFO - Categorical columns: ['location_id', 'seismic_zone']
[ 2025-10-08 00:20:40,587 ] 183 root - INFO - Numerical columns: ['3d_surface_coord_x', '3d_surface_coord_y', '3d_surface_coord_z', 'pore_pressure_kpa', 'subsurface_displacement_mm', 'precipitation_rate_mm_hr', 'ground_acceleration_g', 'realtime_water_table_m', 'cumulative_precip_72hr', 'cumulative_precip_168hr', 'ucs_mpa', 'pga_g', 'initial_water_table_m', 'realtime_minus_initial_water', 'disp_velocity', 'disp_acceleration', 'precipitation_rate_roll6', 'precipitation_rate_roll24', 'pore_pressure_roll6', 'pore_pressure_roll24', 'subsurface_displacement_roll6', 'subsurface_displacement_roll24', 'ground_acceleration_roll6', 'ground_acceleration_roll24', 'precipitation_rate_std6', 'precipitation_rate_std24', 'pore_pressure_std6', 'pore_pressure_std24', 'subsurface_displacement_std6', 'subsurface_displacement_std24', 'ground_acceleration_std6', 'ground_acceleration_std24', 'precipitation_rate_max6', 'precipitation_rate_max24', 'pore_pressure_max6', 'pore_pressure_max24', 'subsurface_displacement_max6', 'subsurface_displacement_max24', 'ground_acceleration_max6', 'ground_acceleration_max24', 'precipitation_rate_lag1', 'precipitation_rate_lag6', 'pore_pressure_lag1', 'pore_pressure_lag6', 'subsurface_displacement_lag1', 'subsurface_displacement_lag6', 'ground_acceleration_lag1', 'ground_acceleration_lag6', 'precipitation_rate_z24', 'pore_pressure_z24', 'subsurface_displacement_z24', 'ground_acceleration_z24']
[ 2025-10-08 00:20:40,591 ] 223 root - INFO - Applying preprocessing object on training and testing dataframes.
[ 2025-10-08 00:20:40,719 ] 46 root - INFO - Entered the save_object method of MainUtils class
[ 2025-10-08 00:20:40,720 ] 50 root - INFO - Exited the save_object method of MainUtils class
[ 2025-10-08 00:20:40,722 ] 46 root - INFO - Entered the save_object method of MainUtils class
[ 2025-10-08 00:20:40,730 ] 50 root - INFO - Exited the save_object method of MainUtils class
[ 2025-10-08 00:20:40,730 ] 259 root - INFO - Data transformation artifact: DataTransformationArtifact(transformed_object_file_path='Artifacts\\10_08_2025_00_20_25\\data_transformation\\transformed_object\\preprocessing.pkl', transformed_train_file_path='Artifacts\\10_08_2025_00_20_25\\data_transformation\\transformed\\train.npy', transformed_test_file_path='Artifacts\\10_08_2025_00_20_25\\data_transformation\\transformed\\test.npy')
[ 2025-10-08 00:20:40,735 ] 37 root - INFO - data Transformation completed
[ 2025-10-08 00:20:40,735 ] 39 root - INFO - Model Training sstared
[ 2025-10-08 00:20:40,763 ] 176 root - INFO - Class distribution in y_train: {np.float64(0.0): np.int64(11227), np.float64(1.0): np.int64(5)}
[ 2025-10-08 00:20:40,825 ] 184 root - INFO - Number of overlapping rows between train and test: 0
[ 2025-10-08 00:20:54,718 ] 664 root - ERROR - XGBoost training failed: Error occured in python script name [C:\Users\dsgau\RockFall-Predictor\rockfallsecurity\utils\ml_utils\metric\classification_metric.py] line number [8] error message [Found input variables with inconsistent numbers of samples: [6048, 6070]]
Traceback (most recent call last):
  File "C:\Users\dsgau\RockFall-Predictor\rockfallsecurity\utils\ml_utils\metric\classification_metric.py", line 8, in get_classification_score
    model_f1_score = f1_score(y_true, y_pred, average='macro')
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dsgau\AppData\Local\Programs\Python\Python311\Lib\site-packages\sklearn\utils\_param_validation.py", line 216, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dsgau\AppData\Local\Programs\Python\Python311\Lib\site-packages\sklearn\metrics\_classification.py", line 1324, in f1_score
    return fbeta_score(
           ^^^^^^^^^^^^
  File "C:\Users\dsgau\AppData\Local\Programs\Python\Python311\Lib\site-packages\sklearn\utils\_param_validation.py", line 189, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dsgau\AppData\Local\Programs\Python\Python311\Lib\site-packages\sklearn\metrics\_classification.py", line 1517, in fbeta_score
    _, _, f, _ = precision_recall_fscore_support(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dsgau\AppData\Local\Programs\Python\Python311\Lib\site-packages\sklearn\utils\_param_validation.py", line 189, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dsgau\AppData\Local\Programs\Python\Python311\Lib\site-packages\sklearn\metrics\_classification.py", line 1830, in precision_recall_fscore_support
    labels = _check_set_wise_labels(y_true, y_pred, average, labels, pos_label)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dsgau\AppData\Local\Programs\Python\Python311\Lib\site-packages\sklearn\metrics\_classification.py", line 1596, in _check_set_wise_labels
    y_type, y_true, y_pred = _check_targets(y_true, y_pred)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dsgau\AppData\Local\Programs\Python\Python311\Lib\site-packages\sklearn\metrics\_classification.py", line 98, in _check_targets
    check_consistent_length(y_true, y_pred)
  File "C:\Users\dsgau\AppData\Local\Programs\Python\Python311\Lib\site-packages\sklearn\utils\validation.py", line 475, in check_consistent_length
    raise ValueError(
ValueError: Found input variables with inconsistent numbers of samples: [6048, 6070]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\dsgau\RockFall-Predictor\rockfallsecurity\components\model_trainer.py", line 644, in train_model
    cls_metric_test_xgb = get_classification_score(y_true=y_test, y_pred=y_pred_test_xgb)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dsgau\RockFall-Predictor\rockfallsecurity\utils\ml_utils\metric\classification_metric.py", line 18, in get_classification_score
    raise RockfallSafetyException(e, sys)
rockfallsecurity.exception.exception.RockfallSafetyException: Error occured in python script name [C:\Users\dsgau\RockFall-Predictor\rockfallsecurity\utils\ml_utils\metric\classification_metric.py] line number [8] error message [Found input variables with inconsistent numbers of samples: [6048, 6070]]
[ 2025-10-08 00:21:14,060 ] 46 root - INFO - Entered the save_object method of MainUtils class
[ 2025-10-08 00:21:14,065 ] 50 root - INFO - Exited the save_object method of MainUtils class
[ 2025-10-08 00:21:14,065 ] 46 root - INFO - Entered the save_object method of MainUtils class
[ 2025-10-08 00:21:14,070 ] 50 root - INFO - Exited the save_object method of MainUtils class
[ 2025-10-08 00:21:14,070 ] 1089 root - INFO - Model trainer artifact: ModelTrainerArtifact(trained_model_file_path='Artifacts\\10_08_2025_00_20_25\\model_trainer\\trained_model\\model.pkl', train_metric_artifact=ClassificationMetricArtifact(f1_score=0.7939617242183549, precision_score=0.7083333333333334, recall_score=0.9996882515364746), test_metric_artifact=ClassificationMetricArtifact(f1_score=1.0, precision_score=1.0, recall_score=1.0))
[ 2025-10-08 00:21:14,074 ] 44 root - INFO - Model Training artifact created
